## Мониторинг серверов в дата-центре.

## 1. Формат сообщения, отправляемого producer-ом

| Поле        | Тип              | Описание                                                                                                   |
| ----------- | ---------------- | ---------------------------------------------------------------------------------------------------------- |
| `eventId`   | `UUID`           | Уникальный идентификатор записи (для дедупликации).                                                        |
| `hostId`    | `String`         | Идентификатор сервера (например `srv-12-rack-03`).                                                         |
| `zone`      | `String`         | Логическая зона дата-центра (`zone-A`, `zone-B` …).                                                        |
| `timestamp` | `long` (ms, UTC) | Время измерения (event-time).                                                                              |
| `metric`    | `String` (enum)  | Тип измерения: `CPU_USAGE`, `MEM_USAGE`, `DISK_IO_READ`, `DISK_IO_WRITE`, `NET_IN`, `NET_OUT`, `CPU_TEMP`. |
| `value`     | `double`         | Значение метрики.                                                                                          |
| `unit`      | `String`         | Единицы измерения (`%`, `MB/s`, `°C`).                                                                     |
| `tags`      | `Object` (опц.)  | Дополнительные атрибуты (может быть пустым).                                                               |


## 2. Ожидаемые результаты (получаются только из `dc_metrics`)

| №   | Результат                                                                                                                                                  |
| --- | ---------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 1   | **Текущий статус хоста** – средние значения каждой метрики за последние 5 сек (обновление каждый 5 сек).                                                   |
| 2   | **SLA-compliance per-host** – % времени, когда метрика превышает порог (CPU > 85 %, MEM > 90 %, DISK IO > 80 %) за скользящие 5-минутные окна (шаг 1 мин). |
| 3   | **Агрегированная нагрузка по зоне** – суммарный CPU % и средняя температура за 1 мин.                                                                      |
| 4   | **Тревоги в реальном времени** – `CPU_USAGE > 95 %` **или** `CPU_TEMP > 85 °C`. При срабатывании сообщение помещается в топик `dc_alerts`.                 |
| 5   | **Часовой тренд CPU %** – суммарный CPU % за каждый час (используется для определения энергопотребления).                                                  |
| 6   | **Дневные/недельные отчёты** – средние значения всех метрик, количество тревог, распределение нагрузки по часам.                                           |


## 3. Отношение к запаздыванию обработки

| Тип результата           | Требуемая максимальная задержка         | Приоритет                                              |
| ------------------------ | --------------------------------------- | ------------------------------------------------------ |
| Тревога (алерт)          | **≤ 2 сек**                             | Критически важно – мгновенное реагирование.            |
| Текущий статус (дашборд) | **≤ 1 сек**                             | Высокая важность – пользователь ожидает «живую» карту. |
| SLA-compliance           | **≤ 5 сек**                             | Средняя важность – небольшая задержка допустима.       |
| Отчёты / тренды          | без ограничения (можно выполнять ночью) | Низкая важность.                                       |


## 4. Потеря данных и требуемая семантика

| Данные                                  | Критичность                                                                                  | Выбранная семантика в Kafka|
| --------------------------------------- | -------------------------------------------------------------------------------------------- | ---------------------------|
| Метрики (каждое событие)                | Средняя-высокая  | **at-least-once** |
| Алёрты (события пороговых срабатываний) | **Критичная** – пропуск алёрта равен пропуску инцидента                                      | **exactly-once** |
| Отчёты / тренды                         | Низкая – могут быть пересчитаны                                                              | **at-least once**|


# Запуск

1. Clone repo:
```bash
git clone --recurse-submodules git@github.com:arsnazarenko/dc-streaming-data-analysis.git
```

2. Run docker compose:
```bash
docker compose up
```

3. Connect to UI:

> Kafka UI: http://localhost:8080

> Flink Web Dashboard: http://localhost:8081

> Streaming API webdocket address ws://localhost:8181/ws

> To launch the streaming client, simply open the [streaming_client.html](streaming_api/static/streaming_client.html) file in your browser. It will automatically connect to ws://localhost:8181/ws

4. Stop docker compose:
```bash
docker compose down
```


